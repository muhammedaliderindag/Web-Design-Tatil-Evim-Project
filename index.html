<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8">
<title>Tatil Evim - Premium Keşif</title>
<meta content="width=device-width, initial-scale=1.0" name="viewport">

<link href="img/favicon.ico" rel="icon">

<link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;600;800&family=Playfair+Display:ital,wght@0,600;1,600&display=swap" rel="stylesheet">

<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">

<link href="lib/animate/animate.min.css" rel="stylesheet">
<link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

<link href="css/style.css" rel="stylesheet">

<style>
    :root {
        /* Ana Renkler - Resimdeki Yeşil Tonları */
        --primary: #00A780;
        --primary-dark: #008f6d;
        --secondary: #FF6922;
        --dark: #06392D;
        --light: #F0FDF9;
        --card-radius: 20px;
        
        /* Bootstrap Renklerini Ezmek İçin Değişkenler */
        --bs-primary: #00A780;
        --bs-primary-rgb: 0, 167, 128;
        --bs-link-color: #00A780;
        --bs-link-hover-color: #008f6d;
    }

    body {
        font-family: 'Manrope', sans-serif;
        background-color: #fff;
        color: var(--dark);
        overflow-x: hidden;
    }

    /* --- BOOTSTRAP OVERRIDES (MAVİYİ YOK ETMEK İÇİN) --- */
    .text-primary { color: var(--primary) !important; }
    .bg-primary { background-color: var(--primary) !important; }
    .border-primary { border-color: var(--primary) !important; }
    
    .btn-primary {
        background-color: var(--primary) !important;
        border-color: var(--primary) !important;
    }
    .btn-primary:hover {
        background-color: var(--primary-dark) !important;
        border-color: var(--primary-dark) !important;
    }
    
    .btn-outline-primary {
        color: var(--primary) !important;
        border-color: var(--primary) !important;
    }
    .btn-outline-primary:hover {
        background-color: var(--primary) !important;
        color: #fff !important;
    }
    
    .badge.bg-primary {
        background-color: var(--primary) !important;
    }

    /* GENİŞ KONTEYNER (TÜM SAYFA HİZALAMASI İÇİN) */
    .custom-wide-container {
        width: 92%;
        max-width: 1800px;
        margin: 0 auto;
    }

    /* 1. NAVBAR */
/* 1. NAVBAR (GÜNCELLENMİŞ) */
.navbar {
background-color: #ffffff;
box-shadow: 0 4px 20px rgba(0,0,0,0.05);
padding: 15px 0;
position: sticky;
top: 0;
z-index: 1000;
transition: all 0.3s;
}
.navbar-brand h1 {
font-size: 1.8rem;
font-weight: 800;
color: var(--primary);
letter-spacing: -0.5px;
margin: 0;
}
/* Navbar Linkleri ve Animasyon */
    .navbar-nav .nav-link { 
        color: var(--dark) !important; 
        font-weight: 600; 
        font-size: 1rem; 
        margin-left: 25px; 
        transition: 0.3s; 
        position: relative; /* Animasyon için referans noktası */
    }
    
    /* Alt Çizgi Animasyonu (::after) */
    .navbar-nav .nav-link::after {
        content: ''; 
        position: absolute; 
        width: 0; 
        height: 2px; 
        bottom: 5px; 
        left: 0; 
        background: var(--primary); 
        transition: 0.3s;
    }
    
    /* Hover ve Active durumunda çizgi uzasın */
    .navbar-nav .nav-link:hover::after, 
    .navbar-nav .nav-link.active::after { 
        width: 100%; 
    }
    
    /* Link üzerine gelince renk değişimi */
    .navbar-nav .nav-link:hover, 
    .navbar-nav .nav-link.active { 
        color: var(--primary) !important; 
    }

    /* Dropdown Menü Kutusu */
    .dropdown-menu { 
        border: none; 
        border-radius: 12px; 
        box-shadow: 0 10px 40px rgba(0,0,0,0.1); 
        padding: 15px; 
        margin-top: 15px; 
        animation: fadeInUp 0.3s; /* Açılma efekti */
    }

    /* Dropdown İçindeki Linklerin Renk Ayarı (Maviyi yok etme) */
    .dropdown-item:active, 
    .dropdown-item:hover,
    .dropdown-item:focus {
        background-color: var(--primary) !important; /* Yeşil Arkaplan */
        color: #fff !important; /* Beyaz Yazı */
    }
    /* 2. HERO SLIDER */
    .hero-container { margin-top: 20px; position: relative; }
    .hero-wrapper {
        position: relative;
        overflow: hidden;
        width: 100%;
        height: 750px;
        border-radius: 30px;
        box-shadow: 0 20px 50px rgba(0,0,0,0.1);
    }
    .owl-carousel-item { height: 750px; width: 100%; overflow: hidden; position: relative; }
    
    @keyframes kenBurns { 0% { transform: scale(1); } 100% { transform: scale(1.15); } }
    .owl-carousel-item img { height: 100% !important; width: 100%; object-fit: cover; animation: kenBurns 12s linear infinite alternate; }

    .owl-carousel-item::before {
        content: ""; position: absolute; bottom: 0; left: 0; width: 100%; height: 60%;
        background: linear-gradient(to top, rgba(6, 57, 45, 0.9) 0%, transparent 100%); z-index: 1;
    }

    .slide-caption-box {
        position: absolute; bottom: 60px; left: 50%; transform: translateX(-50%);
        z-index: 2; text-align: center; width: 90%; max-width: 800px;
    }
    .slide-tag { display: inline-block; background: rgba(255,255,255,0.2); backdrop-filter: blur(5px); color: #fff; padding: 5px 15px; border-radius: 20px; font-size: 0.85rem; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 15px; border: 1px solid rgba(255,255,255,0.3); }
    .slide-title { font-family: 'Playfair Display', serif; font-size: 3.5rem; font-weight: 700; color: white; margin-bottom: 10px; text-shadow: 0 5px 15px rgba(0,0,0,0.5); animation: fadeInUp 1s ease-out; }
    .slide-desc { font-size: 1.2rem; color: rgba(255,255,255,0.9); font-weight: 300; margin-bottom: 25px; animation: fadeInUp 1.2s ease-out; }
    .slide-btn { padding: 12px 35px; border-radius: 50px; font-weight: 600; background: #fff; color: var(--primary); text-decoration: none; transition: 0.3s; box-shadow: 0 5px 15px rgba(0,0,0,0.3); display: inline-block; animation: fadeInUp 1.4s ease-out; }
    .slide-btn:hover { background: var(--primary); color: #fff; transform: translateY(-3px); }

    @media (max-width: 768px) { .hero-wrapper, .owl-carousel-item { height: 500px; } .slide-title { font-size: 2rem; } .slide-desc { font-size: 1rem; } }

    /* 4. KARTLAR */
    .reveal { opacity: 0; transform: translateY(30px); transition: all 0.8s ease-out; }
    .reveal.active { opacity: 1; transform: translateY(0); }

    .property-item { background: #fff; border: none; border-radius: var(--card-radius); margin-bottom: 40px; transition: all 0.4s ease; box-shadow: 0 10px 30px rgba(0,0,0,0.05); position: relative; overflow: hidden; }
    .property-item:hover { transform: translateY(-10px); box-shadow: 0 20px 50px rgba(0,0,0,0.15); }
    .card-img-wrap { height: 400px; overflow: hidden; position: relative; }
    .card-img-wrap img { width: 100%; height: 100%; object-fit: cover; transition: transform 0.6s ease; }
    .property-item:hover img { transform: scale(1.1); }
    
    .badge-overlay { position: absolute; top: 20px; left: 20px; z-index: 2; display: flex; gap: 10px; }
    .badge-custom { background: rgba(255,255,255,0.9); backdrop-filter: blur(5px); padding: 8px 16px; border-radius: 30px; font-size: 0.8rem; font-weight: 700; color: var(--dark); box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
    .fav-icon { position: absolute; top: 20px; right: 20px; z-index: 2; background: white; width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #ccc; transition: 0.3s; cursor: pointer; }
    .fav-icon:hover { color: #ff4757; transform: scale(1.1); }

    .card-content { padding: 25px; position: relative; }
    .listing-title { font-size: 1.35rem; font-weight: 800; color: var(--dark); }
    .listing-features { display: flex; gap: 15px; margin: 10px 0; font-size: 0.9rem; color: #666; border-bottom: 1px solid #eee; padding-bottom: 15px; }
    .feature-item i { color: var(--primary); margin-right: 5px; }
    .listing-footer { display: flex; justify-content: space-between; align-items: center; padding-top: 5px; }
    .listing-price { font-size: 1.4rem; font-weight: 800; color: var(--primary); margin: 0; }
    .btn-detail { border: 2px solid var(--dark); background: transparent; color: var(--dark); border-radius: 30px; padding: 8px 20px; font-weight: 700; transition: 0.3s; }
    .btn-detail:hover { background: var(--dark); color: white; }

    /* 5. İSTATİSTİKLER (YEŞİL TEMA GÜNCELLEMESİ) */
    .stats-section { 
        background: linear-gradient(45deg, #00A780, #045D48, #00A780); 
        background-size: 200% 200%; 
        animation: gradientBG 10s ease infinite; 
        padding: 100px 0; 
        margin-top: 100px; 
        color: #fff; 
        position: relative; 
        overflow: hidden; 
    }
    @keyframes gradientBG { 0% {background-position: 0% 50%;} 50% {background-position: 100% 50%;} 100% {background-position: 0% 50%;} }
    .circle-decor { position: absolute; border-radius: 50%; background: rgba(255,255,255,0.1); }
    .circle-1 { width: 300px; height: 300px; top: -100px; left: -100px; }
    .circle-2 { width: 500px; height: 500px; bottom: -200px; right: -200px; }
    .stat-item { text-align: center; position: relative; z-index: 2; }
    .stat-icon-wrapper { width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 50%; margin: 0 auto 20px; display: flex; align-items: center; justify-content: center; font-size: 2.5rem; backdrop-filter: blur(5px); border: 1px solid rgba(255,255,255,0.3); }
    .counter { font-size: 4rem; font-weight: 800; margin-bottom: 5px; line-height: 1; }
    .stat-label { font-size: 1.1rem; text-transform: uppercase; letter-spacing: 2px; font-weight: 600; opacity: 0.9; }
    @media (max-width: 991px) { .stat-item { margin-bottom: 40px; } }
</style>
</head>
<body>
<nav class="navbar navbar-expand-lg">
    <div class="container-fluid px-5">
        <a href="index.html" class="navbar-brand d-flex align-items-center">
            <div class="bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-2" style="width: 45px; height: 45px;">
                <i class="fa fa-umbrella-beach fs-4"></i>
            </div>
            <h1 class="m-0 fs-2">Tatil Evim</h1>
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"><span class="navbar-toggler-icon"></span></button>
        <div class="collapse navbar-collapse" id="navbarCollapse">
            <div class="navbar-nav ms-auto align-items-center">
                <a href="index.html" class="nav-item nav-link active">Ana Sayfa</a>
                <a href="about.html" class="nav-item nav-link">Hakkımızda</a>
                <a href="misyon-vizyon.html" class="nav-item nav-link">Misyon</a>
                <!-- MANUEL OK İŞARETİ EKLENDİ -->
                <div class="nav-item dropdown">
                    <a href="#" class="nav-link" data-bs-toggle="dropdown">Tatil Evlerimiz <i class="fa fa-chevron-down small ms-1"></i></a>
                    <div class="dropdown-menu rounded-0 m-0">
                        <a href="villalar.html" class="dropdown-item">Özel Villalar</a>
                        <a href="bungalovlar.html" class="dropdown-item">Doğa Bungalovları</a>
                        <a href="apartlar.html" class="dropdown-item">Apart Daireler</a>
                    </div>
                </div>
                <!-- /MANUEL OK İŞARETİ SONU -->
                <a href="duyurular.html" class="nav-item nav-link">Kampanyalar</a>
                <a href="contact.html" class="nav-item nav-link">İletişim</a>
                <a href="admin.html" class="nav-item nav-link text-danger fw-bold ms-4">Yönetim</a>
            </div>
        </div>
    </div>
</nav>

<div class="custom-wide-container hero-container">
    <div class="hero-wrapper">
        <div class="owl-carousel header-carousel" id="dynamicSlider">
            </div>
    </div>
</div>

<div class="custom-wide-container mt-5 pt-5 reveal">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <span class="text-primary fw-bold text-uppercase d-block mb-1">Sınırlı Fırsatlar</span>
            <h3 class="fw-bold m-0 display-6">Son Kampanyalar</h3>
        </div>
        <a href="duyurular.html" class="btn btn-outline-dark rounded-pill px-4">Tümünü Gör <i class="fa fa-arrow-right ms-2"></i></a>
    </div>
    <div class="row g-4" id="anasayfaDuyuruListesi"></div>
</div>

<div class="custom-wide-container mt-5 pt-3 reveal">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <span class="text-primary fw-bold text-uppercase d-block mb-1">Premium Seçimler</span>
            <h3 class="fw-bold m-0 display-6">Öne Çıkan Evler</h3>
        </div>
    </div>
    <div class="row g-4" id="oneCikanListesi"></div>
    <div class="text-center mt-5">
        <a href="villalar.html" class="btn btn-dark rounded-pill px-5 py-3 fw-bold shadow-lg">Daha Fazla Keşfet</a>
    </div>
</div>

<div class="stats-section reveal">
    <div class="circle-decor circle-1"></div>
    <div class="circle-decor circle-2"></div>
    <div class="custom-wide-container">
        <div class="row">
            <div class="col-md-3 stat-item">
                <div class="stat-icon-wrapper"><i class="fa fa-home"></i></div>
                <div class="counter" data-target="0" id="statEv">0</div>
                <div class="stat-label">Lüks Villa</div>
            </div>
            <div class="col-md-3 stat-item">
                <div class="stat-icon-wrapper"><i class="fa fa-map-marked-alt"></i></div>
                <div class="counter" data-target="0" id="statBolge">0</div>
                <div class="stat-label">Popüler Bölge</div>
            </div>
            <div class="col-md-3 stat-item">
                <div class="stat-icon-wrapper"><i class="fa fa-smile-beam"></i></div>
                <div class="counter" data-target="0" id="statMisafir">0</div>
                <div class="stat-label">Mutlu Misafir</div>
            </div>
            <div class="col-md-3 stat-item">
                <div class="stat-icon-wrapper"><i class="fa fa-fire"></i></div>
                <div class="counter" data-target="0" id="statKampanya">0</div>
                <div class="stat-label">Aktif Fırsat</div>
            </div>
        </div>
    </div>
</div>

<div class="container-fluid bg-dark text-white-50 footer pt-5 mt-5 wow fadeIn" data-wow-delay="0.1s">
    <div class="custom-wide-container py-5">
        <div class="row g-5">
            <div class="col-lg-4 col-md-6">
                <h5 class="text-white mb-4">Tatil Evim</h5>
                <p>Hayallerinizdeki tatili gerçeğe dönüştürmek için Ege ve Akdeniz'in en özel villalarını, bungalovlarını ve apartlarını sizlerle buluşturuyoruz.</p>
                <div class="d-flex pt-2">
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-twitter"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-facebook-f"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-instagram"></i></a>
                    <a class="btn btn-outline-light btn-social" href="#"><i class="fab fa-youtube"></i></a>
                </div>
            </div>
            <div class="col-lg-4 col-md-6">
                <h5 class="text-white mb-4">Hızlı Erişim</h5>
                <a class="btn btn-link text-white-50" href="index.html">Ana Sayfa</a>
                <a class="btn btn-link text-white-50" href="about.html">Hakkımızda</a>
                <a class="btn btn-link text-white-50" href="villalar.html">Villalar</a>
                <a class="btn btn-link text-white-50" href="duyurular.html">Kampanyalar</a>
                <a class="btn btn-link text-white-50" href="contact.html">İletişim</a>
                <a class="btn btn-link text-white-50" href="admin.html">Yönetim Paneli</a>
            </div>
            <div class="col-lg-4 col-md-6">
                <h5 class="text-white mb-4">İletişim Bilgileri</h5>
                <p class="mb-2"><i class="fa fa-map-marker-alt me-3"></i>Kocaeli Üniversitesi, Teknoloji Fakültesi</p>
                <p class="mb-2"><i class="fa fa-phone-alt me-3"></i>+90 532 000 00 00</p>
                <p class="mb-2"><i class="fa fa-envelope me-3"></i>info@tatilevim.com</p>
            </div>
        </div>
    </div>
    <div class="custom-wide-container">
        <div class="copyright">
            <div class="row">
                <div class="col-md-6 text-center text-md-start mb-3 mb-md-0">
                    &copy; <a class="border-bottom" href="index.html">Tatil Evim</a>, Tüm Hakları Saklıdır.
                </div>
            </div>
        </div>
    </div>
</div>

<div id="modalContainer"></div>

<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="lib/owlcarousel/owl.carousel.min.js"></script>
<script src="js/main.js"></script>

<script>
    function resimYolunuGetir(resimString) {
        if (!resimString) return 'img/carousel-1.jpg';
        if (resimString.startsWith('data:image')) return resimString;
        return 'img/' + resimString;
    }

    // --- SLIDER İÇİN AKILLI SLOGAN ÜRETİCİ ---
    function getSlogan(ilan) {
        const tur = ilan.tur.toLowerCase();
        const bolge = ilan.bolge;
        if(tur.includes('villa')) return `Lüks ve Konforun ${bolge}'daki Adresi`;
        if(tur.includes('bungalov')) return `${bolge} Doğasıyla İç İçe Bir Mola`;
        if(tur.includes('apart')) return `Evinizin Sıcaklığı, ${bolge}'nın Güzelliği`;
        return `${bolge}'da Unutulmaz Bir Tatil Deneyimi`;
    }

    // --- SCROLL ANIMATION ---
    function setupScrollReveal() {
        const reveals = document.querySelectorAll('.reveal');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if(entry.isIntersecting) {
                    entry.target.classList.add('active');
                }
            });
        }, { threshold: 0.1 });
        reveals.forEach(reveal => observer.observe(reveal));
    }

    // --- COUNTER UP ---
    function animateValue(obj, start, end, duration) {
        let startTimestamp = null;
        const step = (timestamp) => {
            if (!startTimestamp) startTimestamp = timestamp;
            const progress = Math.min((timestamp - startTimestamp) / duration, 1);
            obj.innerHTML = Math.floor(progress * (end - start) + start);
            if (progress < 1) window.requestAnimationFrame(step);
        };
        window.requestAnimationFrame(step);
    }

    document.addEventListener('DOMContentLoaded', function() {
        setupScrollReveal();

        let ilanlar = JSON.parse(localStorage.getItem('ilanlar')) || [];
        if(ilanlar.length === 0) { 
            ilanlar = [
                {id:101, baslik:"Kaş Lüks Villa", fiyat:"15.000", tur:"Villa", bolge:"Kaş", resim:"property-1.jpg", oneCikan:true, kapasite:6},
                {id:102, baslik:"Fethiye Doğa Bungalov", fiyat:"8.000", tur:"Bungalov", bolge:"Fethiye", resim:"property-2.jpg", oneCikan:true, kapasite:2},
                {id:103, baslik:"Bodrum Deniz Manzaralı", fiyat:"22.500", tur:"Villa", bolge:"Bodrum", resim:"property-3.jpg", oneCikan:true, kapasite:8},
                {id:104, baslik:"Sapanca Göl Evi", fiyat:"6.500", tur:"Bungalov", bolge:"Sapanca", resim:"property-4.jpg", oneCikan:true, kapasite:4}
            ];
            localStorage.setItem('ilanlar', JSON.stringify(ilanlar)); 
        }

        // 1. SLIDER
        const sliderContainer = document.getElementById('dynamicSlider');
        let sliderItems = ilanlar.filter(i => i.oneCikan);
        if(sliderItems.length === 0) sliderItems = ilanlar.slice(0, 3);

        let sliderHTML = "";
        sliderItems.forEach(item => {
            const slogan = getSlogan(item);
            sliderHTML += `
            <div class="owl-carousel-item" style="cursor:pointer;" onclick="window.location.href='ilan-detay.html?id=${item.id}'">
                <img src="${resimYolunuGetir(item.resim)}" alt="${item.baslik}">
                <div class="slide-caption-box">
                    <span class="slide-tag">${item.bolge} • ${item.tur}</span>
                    <h2 class="slide-title">${item.baslik}</h2>
                    <p class="slide-desc">${slogan}</p>
                    <a href="ilan-detay.html?id=${item.id}" class="slide-btn">Keşfet <i class="bi bi-arrow-right"></i></a>
                </div>
            </div>`;
        });
        sliderContainer.innerHTML = sliderHTML;

        $('.header-carousel').owlCarousel('destroy'); 
        $(".header-carousel").owlCarousel({
            autoplay: true,
            autoplayTimeout: 6000,
            smartSpeed: 1500, 
            items: 1,
            dots: true,
            loop: true,
            nav: false,
            margin: 0,
            animateOut: 'fadeOut'
        });

        // 2. KARTLAR (Dinamik Puan Hesaplamalı ve Özelleştirilmiş)
        const listingsContainer = document.getElementById('oneCikanListesi');
        const tumYorumlar = JSON.parse(localStorage.getItem('yorumlar')) || [];

        listingsContainer.innerHTML = ilanlar.slice().reverse().filter(i=>i.oneCikan).map(i => {
            // Dinamik puan hesaplama
            const buIlaninYorumlari = tumYorumlar.filter(y => y.ilanId == i.id);
            let ortalamaPuan = "Yeni";
            
            if (buIlaninYorumlari.length > 0) {
                const toplam = buIlaninYorumlari.reduce((acc, curr) => acc + parseInt(curr.puan), 0);
                ortalamaPuan = (toplam / buIlaninYorumlari.length).toFixed(1);
            }

            return `
            <div class="col-lg-4 col-md-6 wow fadeInUp">
                <div class="property-item">
                    <div class="badge-overlay">
                        <span class="badge-custom bg-white text-dark"><i class="fa fa-star text-warning"></i> ${ortalamaPuan}</span>
                    </div>
                    <a href="ilan-detay.html?id=${i.id}" class="text-decoration-none">
                        <div class="card-img-wrap">
                            <img src="${resimYolunuGetir(i.resim)}" alt="${i.baslik}">
                        </div>
                        <div class="card-content">
                            <h5 class="listing-title text-truncate">${i.baslik}</h5>
                            <div class="listing-features">
                                <span class="feature-item"><i class="fa fa-map-marker-alt"></i> ${i.bolge}</span>
                                <span class="feature-item"><i class="fa fa-user"></i> ${i.kapasite}</span>
                                <span class="feature-item"><i class="fa fa-home"></i> ${i.tur}</span>
                            </div>
                            <div class="listing-footer">
                                <p class="listing-price">${i.fiyat} ₺ <span class="text-muted small fw-normal">/ gece</span></p>
                                <button class="btn-detail">İncele <i class="bi bi-arrow-right"></i></button>
                            </div>
                        </div>
                    </a>
                </div>
            </div>`;
        }).join('');

        // 3. KAMPANYALAR (Son 3 Tane)
        const duyurular = JSON.parse(localStorage.getItem('duyurular')) || [];
        let duyuruHTML = ""; let modalHTML = "";
        if(duyurular.length === 0) {
            duyuruHTML = '<div class="alert alert-light w-100 text-center text-muted">Şu an aktif bir fırsat bulunmuyor.</div>';
        } else {
            // Sadece son 3 kampanya
            duyurular.reverse().slice(0, 3).forEach(d => {
                const dosyaVar = d.dosya && d.dosya !== 'Yok';
                const dosyaIsmi = d.dosyaAdi || 'Dosya';
                
                duyuruHTML += `
                <div class="col-lg-4 col-md-6">
                    <div class="bg-white rounded-4 p-4 shadow-sm h-100 position-relative border border-light">
                        <span class="badge bg-primary mb-3">${d.tarih}</span>
                        <h4 class="fw-bold mb-2">${d.baslik}</h4>
                        <p class="text-muted small mb-4">${d.kisa}</p>
                        <button class="btn btn-outline-primary rounded-pill px-4 btn-sm" onclick="$('#m${d.id}').modal('show')">Detaylar</button>
                    </div>
                </div>`;

                modalHTML += `
                <div class="modal fade" id="m${d.id}" tabindex="-1">
                    <div class="modal-dialog modal-dialog-centered">
                        <div class="modal-content rounded-4 border-0">
                            <div class="modal-header border-0 bg-primary text-white">
                                <h5 class="modal-title">${d.baslik}</h5>
                                <button class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                            </div>
                            <div class="modal-body p-4">
                                <p class="text-dark">${d.detay}</p>
                                ${dosyaVar ? `<hr><div class="bg-light p-3 rounded d-flex justify-content-between align-items-center">
                                    <div class="text-truncate me-2"><i class="fa fa-paperclip me-2 text-primary"></i><small class="fw-bold">${dosyaIsmi}</small></div>
                                    <a href="${d.dosya}" download="${dosyaIsmi}" class="btn btn-sm btn-primary rounded-pill"><i class="fa fa-download"></i></a>
                                </div>` : ''}
                            </div>
                        </div>
                    </div>
                </div>`;
            });
        }
        document.getElementById('anasayfaDuyuruListesi').innerHTML = `<div class="row g-4">${duyuruHTML}</div>`;
        document.getElementById('modalContainer').innerHTML = modalHTML;

        // 4. İSTATİSTİKLER
        const bolgeler = [...new Set(ilanlar.map(i => i.bolge))].length;
        const rezervasyonlar = JSON.parse(localStorage.getItem('rezervasyonlar')) || [];
        const mutluMisafirSayisi = 150 + (rezervasyonlar.length * 4);
        const kampanyaSayisi = duyurular.length;
        const evSayisi = ilanlar.length;

        const statsSection = document.querySelector('.stats-section');
        const statsObserver = new IntersectionObserver((entries) => {
            if(entries[0].isIntersecting) {
                animateValue(document.getElementById('statEv'), 0, evSayisi, 2000);
                animateValue(document.getElementById('statBolge'), 0, bolgeler, 2000);
                animateValue(document.getElementById('statMisafir'), 0, mutluMisafirSayisi, 2000);
                animateValue(document.getElementById('statKampanya'), 0, kampanyaSayisi, 2000);
                statsObserver.disconnect();
            }
        }, { threshold: 0.5 });
        statsObserver.observe(statsSection);
    });
</script>
</body>
</html>